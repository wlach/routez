<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

  <link href="lib/stylesheets/scaffold.css" rel="stylesheet" type="text/css" />
  <link href="lib/stylesheets/style.css" rel="stylesheet" type="text/css" />

  <script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2&amp;key={{ key }}"></script>
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/yahoo/yahoo-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/cookie/cookie-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/dragdrop/dragdrop-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/element/element-beta-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/animation/animation-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/resize/resize-min.js"></script>
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/layout/layout-min.js"></script>
  <script type="text/javascript" src="lib/javascripts/labeled_marker.js"></script>
  <script type="text/javascript" src="lib/javascripts/openrp.js" type="text/javascript"></script>

  <script type="text/javascript">
    function load() {
        // hide the route plan when the page is first loaded
        document.getElementById('route-plan-options').style.display = 'none';
        document.getElementById('route-plan').style.display = 'none';
        setupLocations();
 
    if (GBrowserIsCompatible()) {
        var map_dom = document.getElementById("map");
        map = new GMap2(map_dom);
        map.addControl(new GLargeMapControl());
        var bb = new GLatLngBounds(new GLatLng({{ min_lat }}, {{ min_lon }}),new GLatLng({{ max_lat }}, {{ max_lon }}));
        map.setCenter(bb.getCenter(), map.getBoundsZoomLevel(bb));
        map.enableDoubleClickZoom();

        geocoder = new GClientGeocoder();
        initIcons();

        //GEvent.addListener(map, "moveend", callbackMoveEnd);
        //GEvent.addListener(map, "zoomend", callbackZoomEnd);
        //callbackMoveEnd();  // Pretend we just moved to current center
      }
    }
  </script>

  <style type="text/css">
    v\:* {
    behavior:url(#default#VML);
    }
  </style>

</head>

<body id="nav_home" onload="load();" onunload="GUnload()" class="yui-skin-sam">

  {% include 'header.html' %}

  <div id="panels">

    <p id="intro">
      <strong>hbus.ca</strong> is <em>an unofficial service</em> providing trip planning for users of the <a href="http://www.halifax.ca/metrotransit/">Metro Transit</a> system in the greater area of Halifax, Nova Scotia.
    </p>

    <div class="panel">
      <h2>Plan a trip</h2>
      <div class="content">
        <form id="routePlan" onSubmit="mysubmit(); return false;">
          <div>
            <label class="from" for="routePlanStart">From</label>
            <span>
              <input class="text" type="text" id="routePlanStart" 
		     onFocus="javascript:locationInputFocused('start');"/>
              <label>Ex.: North and Agricola</label>
            </span>
          </div>
          <div>
            <label class="to" for="routePlanEnd">To</label>
            <span>
              <input class="text" type="text" id="routePlanEnd" 
		     onFocus="javascript:locationInputFocused('end');"/>
              <label>Ex.: 1496 Lower Water</label>
            </span>
          </div>
          <a href="javascript:reverseDirections()" class="reverse" title="Reverse Directions">Reverse Directions</a>
          <div>
            <label class="time" for="time">Time:</label>
            <span>
              <input class="text" type="text" id="time" class="textfield" value="{{now}}" onFocus="select();"/>
              <label>Ex.: Saturday at 5pm</label>
            </span>
          </div>
          <div class="submit">
            <p class="error" id="error-from" style="display:none;">Didn't understand "from" location.</p>
            <p class="error" id="error-to" style="display:none;">Didn't understand "to" location.</p>
            <input value="Plan!" class="button" type="submit" id="plan-button"/>
          </div>
        </form>
      </div>
    </div>

    <div id="route-plan-options" class="panel">
      <h2>Alternate Routes</h2>
      <div class="content">
        <ul class="options">
          <li class="content-element" id="routeOption1" onmouseover="document.getElementById('routeOption1').style.background = '#F2F5F5';" onmouseout="document.getElementById('routeOption1').style.background = '#FFFFFF';">
            <ul class="directions">
              <li class="bus">7</li>
              <li class="bus">10</li>
            </ul>
            <span class="time_range">9:00am-9:40am</span>
            <span class="time">(40 minutes)</span>
            <span class="walking_time">7 minutes walking time</span>
          </li>
          <li class="content-element" id="routeOption2" onmouseover="document.getElementById('routeOption2').style.background = '#F2F5F5';" onmouseout="document.getElementById('routeOption2').style.background = '#FFFFFF';">
            <ul class="directions">
              <li class="bus">10</li>
              <li class="bus">23</li>
              <li class="ferry">ALD</li>
              <li class="bus">109</li>
            </ul>
            <span class="time_range">9:00am-10:40am</span>
            <span class="time">(1:40 minutes)</span>
            <span class="walking_time">17 minutes walking time</span>
          </li>
        </ul>
      </div>
    </div>

    <div id="route-plan" class="panel">
      <h2>Directions</h2>
      <div class="content">
        <div id="route-plan-content"></div>
        <p class="feedback">Did that sound sensible? Was it what you expected? <a href="mailto:wrlach@gmail.com">Let me know.</a></p>
      </div>
    </div>

    {% include 'footer.html' %}

  </div>

  <div id="map"></div>

  <script>
    (function() {
      var Dom = YAHOO.util.Dom,
          Event = YAHOO.util.Event;

      Event.onDOMReady(function() {
        var layout = new YAHOO.widget.Layout({
          units: [
            { position: 'top', body: 'header', gutter: '0', height: 60 },
            { position: 'left', body: 'panels', gutter: '0', collapse: true, animate: false, scroll: true, width: 300 },
            { position: 'center', body: 'map', gutter: '0' }
          ]
        });
        layout.render();
      }); 
    })();
  </script>

</body>

</html>
