<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

  <link href="site_media/stylesheets/scaffold.css" rel="stylesheet" type="text/css" />
  <link href="site_media/stylesheets/style.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/yahoo/yahoo-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/cookie/cookie-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/element/element-beta-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/layout/layout-min.js"></script>
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/event/event-min.js"></script> 
  <script src="http://yui.yahooapis.com/2.6.0/build/connection/connection-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/history/history-min.js"></script> 
  <script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/json/json-min.js"></script> 
  <script type="text/javascript" src="http://tile.cloudmade.com/wml/0.2/web-maps-lite.js"></script>
  <script type="text/javascript" src="site_media/javascripts/openrp.js" type="text/javascript"></script>

  <script type="text/javascript">
    function load() {
        // initialize map
        var cloudmade = new CM.Tiles.CloudMade.Web({key: '{{ key }}',styleId: 4});
        bb = new CM.LatLngBounds(new CM.LatLng({{ min_lat }}, {{ min_lon }}),new CM.LatLng({{ max_lat }}, {{ max_lon }}));
        map = new CM.Map('map', cloudmade);
        map.addControl(new CM.LargeMapControl());
        initIcons();
        map.enableScrollWheelZoom();
        map.enableDoubleClickZoom();
        map.enableShiftDragZoom();

        YAHOO.util.History.initialize("yui-history-field", "yui-history-iframe"); 
        var routezBookmarkedState = YAHOO.util.History.getBookmarkedState("plan");
        var routezInitialState = routezBookmarkedState || "default"; 
        function routezStateChangeHandler (state) {
            if (setupRoutePlanForm(state)) {
                submitRoutePlan();
            } else {
                  document.getElementById('route-plan').style.display = 'none';
                  map.setCenter(bb.getCenter(), map.getBoundsZoomLevel(bb));
                  map.clearOverlays();
            } 
        }
        YAHOO.util.History.register("plan", routezInitialState, 
                                    routezStateChangeHandler); 

        YAHOO.util.History.onReady(function () {
            // if, after setting up our routePlan form, we discover that it should be submitted, do that. 
            // otherwise, set up the map to something central
            if (setupRoutePlanForm(YAHOO.util.History.getCurrentState("plan"))) {
                submitRoutePlan();
            } else {
                  document.getElementById('route-plan').style.display = 'none';
                  var bb = new CM.LatLngBounds(new CM.LatLng({{ min_lat }}, {{ min_lon }}),new CM.LatLng({{ max_lat }}, {{ max_lon }}));
                  map.setCenter(bb.getCenter(), map.getBoundsZoomLevel(bb));
                  map.clearOverlays();
            }
        });
    }
  </script>

  <style type="text/css">
    v\:* {
    behavior:url(#default#VML);
    }
  </style>

</head>
<body id="nav_home" onload="load();" class="yui-skin-sam">

  <iframe id="yui-history-iframe" src="site_media/images/header_bg.gif"></iframe> 
  <input id="yui-history-field" type="hidden"></input> 

  {% include 'header.html' %}

  <div id="panels">

    <div id="intro">
      <p>
      <strong>hbus.ca</strong> is <em>an unofficial service</em> providing trip planning for users of the <a href="http://www.halifax.ca/metrotransit/">Metro Transit</a> system in the greater area of Halifax, Nova Scotia.
      </p>
      <p>Note that this site is <b>still under development</b> and not yet intended for consumption of the general public. That being said, you may still find it useful. If you're reading this, please consider providing <a onclick="this.blur(); try { UserVoice.PopIn.show(); return false; } catch(e){}" href="http://hbus.uservoice.com/">feedback</a>.</p>
    </div>

    {% include 'routeplan-form.html' %}

    <div id="route-plan-options" class="panel">
      <h2>Alternate Routes</h2>
      <div class="content">
        <ul class="options">
          <li class="content-element" id="routeOption1" onmouseover="document.getElementById('routeOption1').style.background = '#F2F5F5';" onmouseout="document.getElementById('routeOption1').style.background = '#FFFFFF';">
            <ul class="directions">
              <li class="bus">7</li>
              <li class="bus">10</li>
            </ul>
            <span class="time_range">9:00am-9:40am</span>
            <span class="time">(40 minutes)</span>
            <span class="walking_time">7 minutes walking time</span>
          </li>
          <li class="content-element" id="routeOption2" onmouseover="document.getElementById('routeOption2').style.background = '#F2F5F5';" onmouseout="document.getElementById('routeOption2').style.background = '#FFFFFF';">
            <ul class="directions">
              <li class="bus">10</li>
              <li class="bus">23</li>
              <li class="ferry">ALD</li>
              <li class="bus">109</li>
            </ul>
            <span class="time_range">9:00am-10:40am</span>
            <span class="time">(1:40 minutes)</span>
            <span class="walking_time">17 minutes walking time</span>
          </li>
        </ul>
      </div>
    </div>

    <div id="route-plan" class="panel">
      <h2>Directions</h2>
      <div class="content">
        <div id="route-plan-content"></div>
        <p class="feedback">Did that sound sensible? Was it what you expected? <a onclick="this.blur(); try { UserVoice.PopIn.show(); return false; } catch(e){}" href="http://hbus.uservoice.com/">Let us know!</a></p>
      </div>
    </div>

    {% include 'footer.html' %}

  </div>

  <div id="map"></div>

  <script>
    (function() {
      var Dom = YAHOO.util.Dom,
          Event = YAHOO.util.Event;

      Event.onDOMReady(function() {
        var layout = new YAHOO.widget.Layout({
          units: [
            { position: 'top', body: 'header', gutter: '0', height: 60 },
            { position: 'left', body: 'panels', gutter: '0', collapse: true, animate: false, scroll: true, width: 288 },
            { position: 'center', body: 'map', gutter: '0' }
          ]
        });
        layout.render();
      }); 
    })();
  </script>
<script src="http://hbus.uservoice.com/pages/general/widgets/tab.js?alignment=right&amp;color=66f" type="text/javascript"></script>
</body>

</html>
